"use strict";const i=require("../common/vendor.js"),h="",l=1e4,m="pat_RHaWUG7hVWOpH5iVBFuJ3LTm40BL7Bpjy3Qi2y9cwOuZY0KfTIXHyp3pwNBNSqq5",p=[],T=[],f=e=>{p.push(e)};f(e=>(e.header||(e.header={}),e.header.Authorization="Bearer "+m,e));const q=e=>{let t={...e};for(const r of p)t=r(t)||t;return t},E=e=>{let t={...e};for(const r of T)t=r(t)||t;return t},a=e=>(console.error("请求错误:",e),Promise.reject(e)),s=e=>{const t={url:"",method:"GET",data:{},header:{"content-type":"application/json"},timeout:l,...e};t.url&&!t.url.startsWith("http")&&(t.url=h+t.url);const r=q(t);return new Promise((d,u)=>{i.index.request({...r,success:n=>{const o=E(n);if(o.statusCode>=200&&o.statusCode<300)d(o.data);else{const c={statusCode:o.statusCode,errMsg:o.errMsg||"请求失败",data:o.data};a(c),u(c)}},fail:n=>{a(n),u(n)}})})};s.get=(e,t={},r={})=>s({url:e,data:t,method:"GET",...r});s.post=(e,t={},r={})=>s({url:e,data:t,method:"POST",...r});s.put=(e,t={},r={})=>s({url:e,data:t,method:"PUT",...r});s.delete=(e,t={},r={})=>s({url:e,data:t,method:"DELETE",...r});exports.request=s;
